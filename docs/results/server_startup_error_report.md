# Отчет об ошибках запуска сервера
**Дата:** 2026-01-23 12:52:00
**Задача:** 1769170727
**Статус:** Ошибка

## Описание проблемы

HTTP сервер не запущен и не может быть автоматически запущен во время тестирования.

```
ConnectionError: HTTPConnectionPool(host='127.0.0.1', port=3456): Max retries exceeded with url: /health (Caused by NewConnectionError("HTTPConnection(host='127.0.0.1', port=3456): Failed to establish a new connection: [Errno 111] Connection refused"))
```

## Затрагиваемые тесты

1. **API тесты:**
   - `test_server_api_only.py` - тестирование API endpoints
   - `test_real_server_integration.py` - интеграционное тестирование

2. **Интеграционные тесты:**
   - `test_full_cycle_with_server.py` - полный цикл с сервером

## Детали ошибки

### Проверка доступности сервера
```
[DEBUG] Проверка доступности сервера на http://127.0.0.1:3456...
[DEBUG] ConnectionError: HTTPConnectionPool(host='127.0.0.1', port=3456): Max retries exceeded with url: /health
[INFO] Сервер не запущен (ConnectionError)
[FAIL] Сервер не запущен и start_server_flag=False
```

## Возможные причины

1. **Сервер не запущен:** Отсутствует запущенный процесс сервера
2. **Неправильный порт:** Сервер может быть настроен на другой порт
3. **Проблемы с конфигурацией:** Ошибки в конфигурационных файлах
4. **Зависимости:** Отсутствующие зависимости или проблемы с импортами

## Текущее состояние

❌ **Ошибка** - API тесты не могут быть выполнены

## Рекомендации по исправлению

1. **Ручной запуск сервера:**
   ```bash
   cd /workspace
   python main.py
   ```

2. **Проверка конфигурации:**
   - Проверить `config/server.yaml`
   - Проверить переменные окружения
   - Проверить порт 3456

3. **Проверка зависимостей:**
   ```bash
   pip install -r requirements-test.txt
   ```

4. **Автоматический запуск в тестах:**
   Некоторые тесты поддерживают автоматический запуск сервера:
   ```bash
   python test/run_tests.py --api  # без --no-start
   ```

## Влияние на тестирование

- **API блок:** 2 теста недоступны
- **Интеграционные тесты:** 1 тест недоступен
- **Общее тестирование:** ~15% функциональности недоступно

## Альтернативные решения

1. **Мок-сервер:** Использовать mock объекты для тестирования API
2. **Юнит-тесты:** Тестировать отдельные компоненты без сервера
3. **Интеграционные тесты с автостартом:** Включить автоматический запуск сервера

## Конфигурация сервера

По умолчанию сервер запускается на:
- **Хост:** 127.0.0.1
- **Порт:** 3456
- **Health endpoint:** /health

## Связанные компоненты

- `src/server.py` - основной файл сервера
- `src/config/server.yaml` - конфигурация сервера
- `main.py` - точка входа для запуска сервера