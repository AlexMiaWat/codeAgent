# ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Cursor CLI

**–î–∞—Ç–∞:** 2026-01-18  
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `script` + `shlex.quote` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è  
**–°—Ç–∞—Ç—É—Å:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: –¢—Ä–æ–π–Ω–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–≤—ã—á–µ–∫

**–ë—ã–ª–æ:**
- `prompt` —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–ª—Å—è –≤—Ä—É—á–Ω—É—é (–∑–∞–º–µ–Ω–∞ `'` –Ω–∞ `'"'"'`)
- –ó–∞—Ç–µ–º `agent_cmd` —Å–Ω–æ–≤–∞ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–ª—Å—è –¥–ª—è `script -c`
- –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ç—Ä–æ–π–Ω–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –∫–æ–º–∞–Ω–¥–∞ –ª–æ–º–∞–ª–∞—Å—å

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `shlex.quote()` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
- –ï–¥–∏–Ω–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ `shlex.join()` –∏–ª–∏ `' '.join(shlex.quote(arg) for arg in parts)`
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—É—Å—Å–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–∞, –∫–∞–≤—ã—á–µ–∫, –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

_–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç –æ–±–Ω–æ–≤–ª–µ–Ω—ã –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è_

---

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### `src/cursor_cli_interface.py`

**–ë—ã–ª–æ:**
```python
escaped_prompt = prompt.replace("'", "'\"'\"'").replace('$', '\\$').replace('`', '\\`')
agent_cmd_parts.extend(["-p", f'\'{escaped_prompt}\''])
agent_cmd = ' '.join(agent_cmd_parts)
escaped_agent_cmd = agent_cmd.replace('"', '\\"')
script_cmd = f'script -q -c "{escaped_agent_cmd}" /dev/null'
```

**–°—Ç–∞–ª–æ:**
```python
import shlex
agent_cmd_parts.extend(["-p", shlex.quote(prompt)])
try:
    agent_cmd = shlex.join(agent_cmd_parts)  # Python 3.8+
except AttributeError:
    agent_cmd = ' '.join(shlex.quote(arg) for arg in agent_cmd_parts)
escaped_for_script = agent_cmd.replace('"', '\\"') if '"' in agent_cmd else agent_cmd
script_cmd = f'script -q -c "{escaped_for_script}" /dev/null'
```

---

## –°—Ç–∞—Ç—É—Å

üîÑ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ...**
