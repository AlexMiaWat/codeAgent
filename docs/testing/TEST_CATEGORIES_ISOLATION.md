# Изоляция категорий тестов

## Проблема пересечений

Ранее были обнаружены пересечения тестов между категориями:
- `test_llm_real.py` был в категориях `openrouter` и `llm`
- `test_model_discovery_and_update.py` был в категориях `openrouter` и `llm`

## Решение

Тесты были изолированы по категориям на основе их функциональности:

### Категория `openrouter` (OpenRouter API)
**Фокус:** Тестирование OpenRouter API и связанных функций

**Тесты:**
- `test_openrouter_api.py` - Базовый тест OpenRouter API
- `test_openrouter_detailed.py` - Детальное тестирование LLMManager
- `test_model_discovery_and_update.py` - Обнаружение моделей через OpenRouter API
- `test_crewai_scenario.py` - CrewAI сценарий с параллельными моделями

**Обоснование:** Все эти тесты связаны с OpenRouter API или используют его для обнаружения моделей.

### Категория `llm` (LLM Core)
**Фокус:** Тестирование базовой функциональности LLM

**Тесты:**
- `test_llm_real.py` - Реальное тестирование LLMManager (генерация, fallback, параллельный режим)

**Обоснование:** Тестирует базовую функциональность LLMManager независимо от конкретного провайдера API.

## Текущее распределение

| Категория | Тестов | Уникальных тестов |
|-----------|--------|-------------------|
| `openrouter` | 4 | 4 |
| `api` | 2 | 2 |
| `cursor` | 2 | 2 |
| `llm` | 1 | 1 |
| `validation` | 1 | 1 |
| `checkpoint` | 2 | 2 |
| `full` | 2 | 2 |
| **Всего** | **14** | **14** |

## Проверка изоляции

Все тесты теперь уникальны в своих категориях. Нет пересечений между категориями.

## Запуск тестов

```bash
# Каждая категория запускает только свои уникальные тесты
python test/run_tests.py --openrouter  # 4 теста
python test/run_tests.py --llm          # 1 тест
python test/run_tests.py --openrouter --llm  # 5 тестов (без дубликатов)
```

## Преимущества изоляции

1. **Четкое разделение ответственности** - каждая категория тестирует свою область
2. **Отсутствие дублирования** - каждый тест запускается только один раз
3. **Быстрая диагностика** - легко понять, какая категория тестов падает
4. **Гибкость запуска** - можно запускать категории независимо или вместе
